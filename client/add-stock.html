<script type="text/ng-template" id="typeahead.html">
    <a>
        <span ng-bind-html="match.model.ticker | uibTypeaheadHighlight:query"></span>
        - {{match.model.name}}
    </a>
</script>

<div class="container-fluid" ng-controller="StockLookupCtrl" >
    <form ng-submit="submit()" role="search">
        <div uib-alert
            class="alert"
            dismiss-on-timeout="3000"
            ng-repeat="alert in alerts"
            close="closeAlert($index)"
            ng-class="'alert-danger'">{{alert.msg}}
        </div>

        <pre>Stock Lookup: {{selectedSymbol.ticker}} {{selectedSymbol.name}}</pre>
        <div class="form-group">
            <input type="text"
            ng-model="selectedSymbol"
            uib-typeahead="stockInfo as stockInfo.ticker for stockInfo in stockCompanies | filter:$viewValue | limitTo:20"
            placeholder="ex: AMD, GE, MMP"
            class="form-control"
            typeahead-template-url="typeahead.html"/>
        </div>

        <button type="submit" class="btn btn-primary" ng-click="toggle = !toggle">
            <span ng-show="toggle">Submit</span>
            <span ng-hide="toggle">Loading <i class="glyphicon glyphicon-cog gly-spin"></i></span>
        </button>
    </form>

    <hr>

    <div >
        <select class="selectpicker show-tick" ng-model="orderStockBy" ng-change="sortStocks()">
            <option value="ticker">Symbol</option>
            <option value="name">Company Name</option>
            <option value="price">Price</option>
            <option value="sector">Sector</option>
        </select>
        <button type="button" class="btn btn-default" ng-click="reverseStockSorting()">
            <span class="glyphicon glyphicon-sort"/>
        </button>
    </div>

    <!-- Favorite Stocks -->
    <div uib-accordion close-others="oneAtATime">
        <div uib-accordion-group class="panel-default" ng-repeat="stock in stocks | filter:{favorite:true} | orderBy:orderStockBy:reverseStockOrder">
            <uib-accordion-heading>
                {{stock.ticker}} - {{stock.name}}
                <i class="favorite glyphicon glyphicon-heart" ng-click="favoriteStock(stock.ticker)"></i>
                <i class="pull-right glyphicon glyphicon-remove"
                    ng-click="removeStock(stock.ticker)"></i>
            </uib-accordion-heading>
            <h5>Sector: {{stock.sector}}</h5>
            <h5>Industry Category: {{stock.industry_category}}</h5>
            <h5>Industry Group: {{stock.industry_group}}</h5>
            <br/>
            <a href="http://www.investopedia.com/university/movingaverage/movingaverages2.asp" target="_blank">Moving Averages</a>
            <h5>MA(15): {{stock.movingAverages.days15}}</h5>
            <h5>MA(50): {{stock.movingAverages.days50}}</h5>
            <h5>MA(100): {{stock.movingAverages.days100}}</h5>
            <h5>MA(200): {{stock.movingAverages.days200}}</h5>
        </div>
    </div>

    <hr>

    <!-- Watched Stocks -->
    <div uib-accordion close-others="oneAtATime">
        <div uib-accordion-group class="panel-default" ng-repeat="stock in stocks | filter:{favorite:false} | orderBy:orderStockBy:reverseStockOrder">
            <uib-accordion-heading>
                {{stock.ticker}} - {{stock.name}}
                <i class="favorite glyphicon glyphicon-heart-empty" ng-click="favoriteStock(stock.ticker)"></i>
                <i class="pull-right glyphicon glyphicon-remove"
                    ng-click="removeStock(stock.ticker)"></i>
            </uib-accordion-heading>

            <h5>Sector: {{stock.sector}}</h5>
            <h5>Industry Category: {{stock.industry_category}}</h5>
            <h5>Industry Group: {{stock.industry_group}}</h5>
            <br/>
            <a href="http://www.investopedia.com/university/movingaverage/movingaverages2.asp" target="_blank">Moving Averages</a>
            <h5>MA(15): {{stock.movingAverages.days15}}</h5>
            <h5>MA(50): {{stock.movingAverages.days50}}</h5>
            <h5>MA(100): {{stock.movingAverages.days100}}</h5>
            <h5>MA(200): {{stock.movingAverages.days200}}</h5>
        </div>
    </div>
</div>
